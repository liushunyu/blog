---
layout:     post
title:      "Docker 基础使用"
subtitle:    "Docker 使用基础命令"
date:       2019-07-02 09:00:00
author:     Shunyu
header-img: img/post-bg-2015.jpg
header-mask: 0.1
catalog: true
tags:
    - docker
    - documentation
---



Docker 简易教程。



## Docker 安装

参考[官方教程](https://docs.docker.com/engine/install/)



## 非 root 用户使用

1、添加 docker 用户组

```
sudo groupadd docker
```



2、将当前用户加入到 docker 用户组

```
sudo usermod -aG docker ${用户名}
```



3、重启 docker 服务

```
sudo systemctl restart docker
```



4、退出当前用户重登一下



## Repository

Repository 命令（[DockerHub](https://hub.docker.com/)）

```bash
# 登录 DockerHub
docker login

# 上传本地镜像到 DockerHub
docker push [REPOSITORY[:TAG]]

# 查看镜像是否存在于 https://hub.docker.com/
docker search [NAME]

# 下载 DockerHub 中的镜像到本地
docker pull [NAME[:TAG]]
```



## Image

Image 命令

```bash
# 查看镜像是否存在于 https://hub.docker.com/
docker search [NAME]

# 利用 pull 命令获取镜像
docker pull [NAME]

# 利用 Dockerfile 创建镜像
# -t 指定新镜像的 name、tag 等；. 表示在当前目录寻找 Dockerfile
docker build -t="[REPOSITORY[:TAG]]" .

# 利用容器创建镜像
# -m 指定说明信息；-a 指定用户信息；
docker commit -m "[INFO]" -a "[AUTHOR]" [CONTAINER ID] [REPOSITORY[:TAG]]

# 查看当前系统中的 images 信息
docker images

# 删除 images
# 若使用 IMAGE ID 删除时报错 image has dependent child images，说明此时该镜像可能存在多个标签；
# 请使用 REPOSITORY[:TAG] 来删除某标签，当所有标签被删光时便会触发删除镜像行为。
docker rmi [REPOSITORY[:TAG] / IMAGE ID]

# 保存镜像
docker save -o [REPOSITORY].tar [REPOSITORY[:TAG]]

# 加载镜像
docker load -i [REPOSITORY].tar
```



## Container

Container 命令

```bash
# 查看 docker 中的 containers 信息
docker ps -a

# 利用镜像启动一个容器
# -i 表示打开并保持 stdout；-t 表示分配一个终端；-d 表示后台运行；--name 指定别名
# -p 端口映射；-v 目录挂载（共享主机目录，绝对路径）
# -p IP:HostPort:ContainerPort | IP::ContainerPort | HostPort:ContainerPort
# -v HostDir:ContainerDir
# --gpus 允许容器使用 gpu
# --gpus all 
docker run -itd --name=[ALIAS] [REPOSITORY[:TAG]]

# 查看 stdout 的 log
docker logs [NAMES / CONTAINER ID]

# 启动容器
docker start [NAMES / CONTAINER ID]

# 停止容器
docker stop [NAMES / CONTAINER ID]

# 停止所有容器
docker stop $(docker ps -a -q)

# 重启容器
docker restart [NAMES / CONTAINER ID]

# 进入容器
docker attach [NAMES / CONTAINER ID]

# 删除容器
docker rm [NAMES / CONTAINER ID]

# 删除所有容器
docker rm $(docker ps -a -q)

# 退出容器并停止(容器终端下)
exit

# 退出容器并后台运行(容器终端下)
快捷键：CTRL + p q (按住 ctrl 不放，分别按 p 和 q)

# 利用容器创建镜像
# -m 指定说明信息；-a 指定用户信息；
docker commit -m "[INFO]" -a "[AUTHOR]" [CONTAINER ID] [REPOSITORY[:TAG]]
```



## 参考资料及致谢

[Docker Documentation](https://docs.docker.com/)

[只要一小时，零基础入门Docker](https://zhuanlan.zhihu.com/p/23599229)

[Docker与Dockerfile极简入门文档](https://blog.csdn.net/qq_33256688/article/details/80319673)

[Docker 容器使用](https://www.runoob.com/docker/docker-container-usage.html)

[详解Docker 端口映射与容器互联](https://www.cnblogs.com/sohuhome/p/9847935.html)

[关于Docker目录挂载的总结](https://www.cnblogs.com/ivictor/p/4834864.html)

[添加当前用户进docker用户组](https://www.jianshu.com/p/8412a99e3a08)

[docker 创建docker用户组，应用用户加入用户组](https://www.cnblogs.com/lijiangjun/p/10722008.html)