---
layout:     post
title:      "pytorch 小技巧"
subtitle:    "pytorch 小技巧"
date:       2020-04-05 09:00:00
author:     Shunyu
header-img: img/post-bg-2015.jpg
header-mask: 0.1
catalog: true
tags:
    - python
    - pytorch
---



记录一些写 pytorch 时候不会的点。



## GPU 使用

指定 GPU

```python
import os
os.environ['CUDA_VISIBLE_DEVICES'] = '0,1'
```



查看 GPU 是否可用

```python
import torch
torch.cuda.is_available()
```



## 保存提取

```python
# 保存整个网络（网络大的时候可能会比较慢）
torch.save(net, 'net.pkl')  
net = torch.load('net.pkl')

# 只保存网络中的参数（速度快, 占内存少）
torch.save(net.state_dict(), 'net_params.pkl')   
net.load_state_dict(torch.load('net_params.pkl'))
```



## 参考资料及致谢

[莫烦PYTHON](https://morvanzhou.github.io/)